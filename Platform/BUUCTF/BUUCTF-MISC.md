# BUUCTF-MISC

- [BUUCTF-MISC](#BUUCTF-MISC)
    - [二维码扫描](#二维码扫描)
    - [Webshell](#Webshell)
    - [神秘龙卷风](#神秘龙卷风)
    - [面具下的flag](#面具下的flag)
    - [刷新过的图片](#刷新过的图片)
    - [[BJDCTF2020]认真你就输了](#[BJDCTF2020]认真你就输了)
    - [菜刀666](#菜刀666)
    - [[BJDCTF2020]藏藏藏](#[BJDCTF2020]藏藏藏)
    - [秘密文件](#秘密文件)
    - [你猜我是个啥](#你猜我是个啥)
    - [神奇的二维码](#神奇的二维码)
    - [鸡你太美](#鸡你太美)
    - [just_a_rar](#just_a_rar)
    - [穿越时空的思念](#穿越时空的思念)
    - [纳尼](#纳尼)
    - [outguess](#outguess)
    - [我有一只马里奥](#我有一只马里奥)
    - [谁赢了比赛？](#谁赢了比赛？)
    - [excel破解](#excel破解)
    - [gakki](#gakki)
    - [来题中等的吧](#来题中等的吧)
    - [base64隐写](base64隐写)
    - [find_me](#find_me)
    - [sqltest](#sqltest)
    - [伟大的侦探](#伟大的侦探)
    - [黑客帝国](#黑客帝国)
    - [你能看懂音符吗](#你能看懂音符吗)
    - [KO](#KO)
    - [你有没有好好看网课?](#你有没有好好看网课?)
    - [ezmisc](#ezmisc)
    - [喵喵喵](#喵喵喵)
    - [caesar](#caesar)
    - [低个头](#低个头)
    - [弱口令](#弱口令)
    - [john-in-the-middle](#john-in-the-middle)
    - [NTFS数据流](#NTFS数据流)
    - [我吃三明治](#我吃三明治)
    - [single_dog](#single_dog)
    - [SXMgdGhpcyBiYXNlPw==](#SXMgdGhpcyBiYXNlPw==)
    - [黄金6年](#黄金6年)
    - [zip](#zip)
    - [间谍启示录](#间谍启示录)
    - [swp](#swp)
    - [吹着贝斯扫二维码](#吹着贝斯扫二维码)
    - [小易的U盘](#小易的U盘)
    - [从娃娃抓起](#从娃娃抓起)
    - [alison_likes_jojo](#alison_likes_jojo)
    - [zips](#zips)
    - [百里挑一](#百里挑一)
    - [爬](#爬)
    - [Attack](#Attack)
    - [千层套路](#千层套路)
    - [girlfriend](#girlfriend)
    - [Game](#Game)
    - [docx](#docx)
    - [CyberPunk](#CyberPunk)
    - [followme](#followme)
    - [USB](#USB)
    - [通行证](#通行证)
    - [虚假的压缩包](#虚假的压缩包)
    - [Network](#Network)
    - [draw](#draw)
    - [明文攻击](#明文攻击)
    - [蜘蛛侠呀](#蜘蛛侠呀)
    - [UTCTF2020-file-header](#UTCTF2020-file-header)
    - [安洵杯-2019-easy-misc](#安洵杯-2019-easy-misc)
    - [MRCTF2020-Hello_misc](#MRCTF2020-Hello_misc)
    - [BSidesSF2019-zippy](#BSidesSF2019-zippy)
    - [MRCTF2020-不眠之夜](#MRCTF2020-不眠之夜)
    - [hashcat](#hashcat)
    - [派大星的烦恼](#派大星的烦恼)
    - [UTCTF2020-zero](#UTCTF2020-zero)
    - [粽子的来历](#粽子的来历)
    - [MRCTF2020-Unravel!!](#MRCTF2020-Unravel!!)
    - [UTCTF2020-basic-forensics](#UTCTF2020-basic-forensics)
    - [WUSTCTF2020-spaceclub](#WUSTCTF2020-spaceclub)
    - [CFI-CTF-2018-webLogon-capture](#CFI-CTF-2018-webLogon-capture)
    - [SCTF2019-电单车](#SCTF2019-电单车)
    - [MRCTF2020-pyFlag](#MRCTF2020-pyFlag)
    - [watevrCTF-2019-Evil-Cuteness](#watevrCTF-2019-Evil-Cuteness)
    - [*CTF2019-otaku](#*CTF2019-otaku)
    - [湖南省赛2019-Findme](#湖南省赛2019-Findme)
    - [UTCTF2020-File-Carving](#UTCTF2020-File-Carving)
    - [GUET-CTF2019-soul-sipse](#GUET-CTF2019-soul-sipse)
    - [HDCTF2019-你能发现什么蛛丝马迹吗](#HDCTF2019-你能发现什么蛛丝马迹吗)
    - [voip](#voip)
    - [Business-Planning-Group](#Business-Planning-Group)
    - [真的很杂](#真的很杂)
    - [UTCTF2020-spectogram](#UTCTF2020-spectogram)
    - [INSHack2017-sanity](#INSHack2017-sanity)
    - [ACTF新生赛2020-剑龙](#ACTF新生赛2020-剑龙)
    - [UTCTF2020-sstv](#UTCTF2020-sstv)
    - [greatescape](#greatescape)
    - [INSHack2019-INSAnity](#INSHack2019-INSAnity)
    - [MRCTF2020-小O的考研复试](#MRCTF2020-小O的考研复试)
    - [BSidesSF2019-table-tennis](#BSidesSF2019-table-tennis)
    - [RCTF2019-disk](#RCTF2019-disk)
    - [key不在这里](#key不在这里)
    - [GKCTF-2021-excel-骚操作](#GKCTF-2021-excel-骚操作)
    - [INSHack2019-gflag](#INSHack2019-gflag)
    - [很好的色彩呃？](#很好的色彩呃？)
    - [ACTF新生赛2020-frequency](#ACTF新生赛2020-frequency)
    - [XMAN2018排位赛-file](#XMAN2018排位赛-file)
    - [MRCTF2020-摇滚DJ-建议大声播放](#MRCTF2020-摇滚DJ-建议大声播放)
    - [大流量分析一](#大流量分析一)
    - [SCTF2019-Ready_Player_One](#SCTF2019-Ready_Player_One)
    - [GUET-CTF2019-520的暗示](#GUET-CTF2019-520的暗示)
    - [GKCTF-2021-你知道apng吗](#GKCTF-2021-你知道apng吗)
    - [DDCTF2018-流量分析](#DDCTF2018-流量分析)
    - [Beautiful_Side](#Beautiful_Side)
    - [DDCTF2018-第四扩展FS](#DDCTF2018-第四扩展FS)
    - [我爱Linux](#我爱Linux)
    - [INSHack2018-42.tar.xz](#INSHack2018-42.tar.xz)
    - [XMAN2018排位赛-AutoKey](#XMAN2018排位赛-AutoKey)
    - [QCTF2018-X-man-Keyword](#QCTF2018-X-man-Keyword)
    - [GKCTF2021-FireFox-Forensics](#GKCTF2021-FireFox-Forensics)
    - [INSHack2017-hiding-in-plain-sight](#INSHack2017-hiding-in-plain-sight)
    - [HDCTF2019-信号分析](#HDCTF2019-信号分析)
    - [BSidesSF2019-diskimage](#BSidesSF2019-diskimage)
    - [RoarCTF2019-forensic](#RoarCTF2019-forensic)
    - [INSHack2017-remote-multimedia-controller](#INSHack2017-remote-multimedia-controller)
    - [INSHack2017-10-cl0v3rf13ld-lane-signal](#INSHack2017-10-cl0v3rf13ld-lane-signal)
    - [NPUCTF2020-misc-碰上彩虹吃定彩虹](#NPUCTF2020-misc-碰上彩虹吃定彩虹)
    - [SUCTF2018-dead_z3r0](#SUCTF2018-dead_z3r0)
    - [INSHack2018-so-deep](#INSHack2018-so-deep)
    - [watevrCTF-2019-Unspaellablle](#watevrCTF-2019-Unspaellablle)
    - [*CTF2019-She](#*CTF2019-She)
    - [XMAN2018排位赛-ppap](#XMAN2018排位赛-ppap)
    - [SUCTF2019-protocol](#SUCTF2019-protocol)
    - [De1CTF2019-Mine-Sweeping](#De1CTF2019-Mine-Sweeping)
    - [羊城杯-2020-signin](#羊城杯-2020-signin)


## 二维码扫描

sudo apt install zbar-tools

## Webshell 后门

用D盾查杀找webshell

## 神秘龙卷风

下载来是rar压缩包,用archpr2爆破得到文本

内容为brainfuck，解密工具Python-Brainfuck-master得到flag

## 面具下的flag

用binwalk分离图片，得到一个压缩包：74DFE.zip,解压得flag.vmdk

linux下用7z解压vmdk文件

第一个文件明显brainfuck解密：flag{N7F5_AD5

第二个明显Ook解密 : _i5_funny!}

flag{N7F5_AD5_i5_funny!}

## 刷新过的图片

考点：F5隐写

利用F5-steganography利用工具

```java
java Extract Misc.jpg
```

查看output.txt发现开头有PK内容，说明是个ZIP文件头，修改后缀名解压得到flag

## snake.jpg

binwalk分离得到压缩包，里面有cipher和key两个文本，打开key  base64解密得到

`What is Nicki Minaj's favorite song that refers to snakes?`

搜索可得到密码为 anaconda

snake还有另外一个英文翻译：Serpent算法 解密即可

http://serpent.online-domain-tools.com/

## [BJDCTF2020]认真你就输了

binwalk发现flag

## 菜刀666

http.request.method==POST,追踪TCP流发现十六进制FF D8开头FF D9结尾，判断为jpg图片.


```py
import binascii
s = "十六进制内容"
with open('1.jpg','wb') as f:
    f.write(binascii.unhexlify(s))
```

得到一张带密码的图片。binwalk分离流量包得到zip，输入密码即可。

## [BJDCTF2020]藏藏藏

kali下foremost分离,得到压缩包，里面是二维码，识别得到flag

## 秘密文件

深夜里，Hack偷偷的潜入了某公司的内网，趁着深夜偷走了公司的秘密文件，公司的网络管理员通过通过监控工具成功的截取Hack入侵时数据流量，但是却无法分析出Hack到底偷走了什么机密文件，你能帮帮管理员分析出Hack到底偷走了什么机密文件吗？ 注意：得到的 flag 请包上 flag{} 提交

过滤FTP流追踪发现rar包，尝试foremost分解

![](./img/secret.png)

然后暴力破解即可。

## 你猜我是个啥

用010打开发现png头，修改后缀为png，发现二维码，扫描后说flag不在这,010查看查找flag发现在末尾

## 神奇的二维码

扫描后未发现flag，binwalk分离四个压缩包，其中有一个base64多次得到的密码是第四个压缩包的密码，音频隐写Audacity


文件->导出为wav

kali
```bash
morse2ascii good.wav
```

将`t`替换为`-`，e替换为`.`

flag{morseisveryveryeasy}

## 鸡你太美

比较两张图片，添加丢失的git头

## just_a_rar

archpr爆破即可，是一张图片，右键查看属性发现flag

## 穿越时空的思念

嫦娥当年奔月后，非常后悔，因为月宫太冷清，她想：早知道让后羿自己上来了，带了只兔子真是不理智。于是她就写了一首曲子，诉说的是怀念后羿在的日子。无数年后，小明听到了这首曲子，毅然决定冒充后羿。然而小明从曲子中听不出啥来，咋办。。（该题目为小写的32位字符，提交即可） 注意：得到的 flag 请包上 flag{} 提交

audacity需要先将两个声道分离，分离立体声到单声道，导出文件wav

用kali的morse2ascii得到32位字符

## 纳尼

添加GIF89

## outguess

右键查看图片属性发现 公正民主公正文明公正和谐
核心价值解码得到abc

outguess -k "abc" -r mmm.jpg hidden.txt

## 我有一只马里奥

下载后点击exe出现1.txt，内容为ntfs flag.txt

猜测是ntfs隐写，用NtfsStreamsEditor扫1.txt

## 谁赢了比赛？

binwalk得到压缩包，暴力破解即可

得到gif图片，stegsolve-frame browser 要是对GIF之类的动图进行分解，把动图一帧帧的放，有时候会是二维码

第310帧有一行文字，保存下来单独对其stegsolve red plane 0发现二维码，扫描得到flag

## excel破解

010打开搜索flag

## gakki

binwalk分离压缩包，爆破压缩包得到文本

```
# -*- coding:utf-8 -*-
#Author: mochu7
# 字频统计
alphabet = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890!@#$%^&*()_+- =\\{\\}[]"
strings = open('./flag.txt').read()

result = {}
for i in alphabet:
	counts = strings.count(i) # 计算出现的次数
	i = '{0}'.format(i)
	result[i] = counts

res = sorted(result.items(),key=lambda item:item[1],reverse=True)  # 排序操作 True降序
for data in res:
	print(data)

for i in res:
	flag = str(i[0])
	print(flag[0],end="")
```

## 来题中等的吧

看图识别摩斯电码

.- .-.. .--. .... .- .-.. .- -...

## base64隐写

```py
# -*- coding: cp936 -*-

b64chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'

with open('1.txt', 'rb') as f:
    bin_str = ''
    for line in f.readlines():
        stegb64 = ''.join(line.split()) # 读取文本每一行
        rowb64 =  ''.join(stegb64.decode('base64').encode('base64').split()) # 把内容编码成原生base64

        offset = abs(b64chars.index(stegb64.replace('=','')[-1])-b64chars.index(rowb64.replace('=','')[-1])) # 文本的base64 - 原生base64
        equalnum = stegb64.count('=') #no equalnum no offset
        if equalnum:
            bin_str += bin(offset)[2:].zfill(equalnum * 2)

        print ''.join([chr(int(bin_str[i:i + 8], 2)) for i in xrange(0, len(bin_str), 8)]) #8 位一组
```

## find_me

右键属性发现盲文 解密即可

https://www.qqxiuzi.cn/bianma/wenbenjiami.php?s=mangwen

## sqltest

文件-导出对象-HTTP

我们可以从中推断出正确的ascii值，在对一个字符进行bool判断时，被重复判断的ASCII值就是正确的字符，最后提取到：

```bash
tshark -r sqltest.pcapng -Y "http.request" -T fields -e http.request.full_uri > data.txt
```

https://www.cnblogs.com/yunqian2017/p/15124198.html


102 108 97 103 123 52 55 101 100 98 56 51 48 48 101 100 53 102 57 98 50 56 102 99 53 52 98 48 100 48 57 101 99 100 101 102 55 125

flag{47edb8300ed5f9b28fc54b0d09ecdef7}

## 伟大的侦探

压缩包密码:摂m墷m卪倕ⅲm仈Z
呜呜呜,我忘记了压缩包密码的编码了,大家帮我解一哈。

用010editor打开 EBCDIC编码得到压缩包密码

里面是跳舞的小人

福尔摩斯-跳舞的小人解密

iloveholmesandwllm

## 黑客帝国

Jack很喜欢看黑客帝国电影，一天他正在上网时突然发现屏幕不受控制，出现了很多数据再滚屏，结束后留下了一份神秘的数据文件，难道这是另一个世界给Jack留下的信息？聪明的你能帮Jack破解这份数据的意义吗？ 注意：得到的 flag 请包上 flag{} 提交

打开发现是十六进制文件 用010editor导入十六进制文件，发现rar开头文件，保存到本地为1.rar，暴力破解得到一张损坏的png图片，010查看发现是JFIF，这是jpg格式特征，修改文件头为jpg的得到图片

## 你能看懂音符吗

压缩包损坏，打开010editor 改成Rar文件头，里面有docx

呀！一不小心把文档里的东西弄没了……

010editor继续查看发现PK文件头，修改后缀为zip

在word的document.xml发现

♭♯♪‖¶♬♭♭♪♭‖‖♭♭♬‖♫♪‖♩♬‖♬♬♭♭♫‖♩♫‖♬♪♭♭♭‖¶∮‖‖‖‖♩♬‖♬♪‖♩♫♭♭♭♭♭§‖♩♩♭♭♫♭♭♭‖♬♭‖¶§♭♭♯‖♫∮‖♬¶‖¶∮‖♬♫‖♫♬‖♫♫§=

音符解密即可

## KO

OoK解密

## 你有没有好好看网课?

flag3 6位数字暴力破解得到文档和mp4

根据文档提示 用pr新建项目-导入mp4 在5.20和7.11发现信息

..... ../... ./... ./... ../
  5,2     3,1    3,1    3,2
   W       L      L      M
dXBfdXBfdXA=

wllmup_up_up 输入压缩包得到图片，010editor在末尾发现flag

## ezmisc

修改宽高 在第二行第6 7列  7是高

## 喵喵喵

stegsolve发现在红绿蓝 0位上方有不一样的东西，可以猜测是LSB隐写

![](./img/miao1.png)

保存为二进制文件，修改多余的文件头 再修改宽高 二维码扫描

https://pan.baidu.com/s/1pLT2J4f

NtfsStreamsEditor软件去提取隐藏文件。（这一步我一直提取失败，没搞懂为什么，后来发现下载的压缩包用WinRAR解压才可以提取到隐藏的文件，据大佬说流隐写得用WinRAR解压

最后得到pyc 反编译即可

```bash
#!/usr/bin/env python
# visit https://tool.lu/pyc/ for more information
import base64

def encode():
    flag = '*************'
    ciphertext = []
    for i in range(len(flag)):
        s = chr(i ^ ord(flag[i])) # flag每个字符转为十进制再与i异或 然后转为字符
        if i % 2 == 0:
            s = ord(s) + 10
        else:
            s = ord(s) - 10
        ciphertext.append(str(s))
    return ciphertext[::-1]

def decode():
    flag = ''
    ciphertext = [
        '96',
        '65',
        '93',
        '123',
        '91',
        '97',
        '22',
        '93',
        '70',
        '102',
        '94',
        '132',
        '46',
        '112',
        '64',
        '97',
        '88',
        '80',
        '82',
        '137',
        '90',
        '109',
        '99',
        '112']
    ciphertext = ciphertext[::-1]
    for i in range(len(ciphertext)):
        if i % 2 == 0:
            s = int(ciphertext[i]) - 10
        else:
            s = int(ciphertext[i]) + 10
        s = chr(i ^ s)
        flag +=  s
        print(flag)

if __name__ == '__main__':
    decode()
```

## caesar
题目：caesar

描述：gmbhjtdbftbs

flag格式：XXX 明文

提交：直接提交明文 （小写）

中文翻译是凯撒，解密皆可

## 低个头

题目：低个头

描述：EWAZX RTY TGB IJN IO KL 请破解该密文 f

lag格式：XXX 明文

提交：直接提交明文（大写）

键盘密码


flag{CTF}

## 弱口令

老菜鸡，伤了神，别灰心，莫放弃，试试弱口令 注意：得到的 flag 请包上 flag{} 提交

打开压缩包，有密码，右边可以发现看不见的密码，复制到新文本sublime 全选可看见摩斯密码

![](./img/ruokol.png)


.... . .-.. .-.. ----- ..-. --- .-. ..- --

摩斯电码解密得到压缩包密码，解压后是一张女神图片

LSB隐写

python2 lsb.py extract 女神.png 1.txt 123456

## john-in-the-middle

导出http对象文件
也可也foremost
 对logo.png进行stegsolve观察

## NTFS数据流

直接用ntfstreameditor2工具读取

## 我吃三明治

foremost分离两张图片

010打开原图对比 在拼接处发现base32 ，解密得到flag

## single_dog

颜文字解密

http://www.atoolbox.net/Tool.php?Id=703

## SXMgdGhpcyBiYXNlPw==

base64隐写

## 黄金6年

下载后是mp4文件，用010打开在末尾发现base64，解码后是rar文件，转二进制文本脚本如下：

```py
import base64

code = "UmFyIRoHAQAzkrXlCgEFBgAFAQGAgADh7ek5VQIDPLAABKEAIEvsUpGAAwAIZmxhZy50eHQwAQADDx43HyOdLMGWfCE9WEsBZprAJQoBSVlWkJNS9TP5du2kyJ275JzsNo29BnSZCgMC3h+UFV9p1QEfJkBPPR6MrYwXmsMCMz67DN/k5u1NYw9ga53a83/B/t2G9FkG/IITuR+9gIvr/LEdd1ZRAwUEAA=="

with open ('1.rar','wb') as f:
    f.write(base64.b64decode(code))
```

压缩包需要密码，在mp4里面二维码，需要分帧,一共4个二维码拼接压缩包密码。



## zip

拼在一起解下base64就有flag 注意：得到的 flag 请包上 flag{} 提交

很多压缩包，但是里面的内容非常小，小于5字节，可以尝试使用CRC32爆破得到其内容

```py
#coding:utf-8
import zipfile
import string
import binascii

def CrackCrc(crc):
    for i in dic:
        for j in dic:
            for p in dic:
                for q in dic:
                    s = i + j + p + q
                    if crc == (binascii.crc32(s) & 0xffffffff):
                        #print s
                        f.write(s)
                        return

def CrackZip():
    for I in range(68):
        file = 'out' + str(I) + '.zip'
        f = zipfile.ZipFile(file, 'r')
        GetCrc = f.getinfo('data.txt')
        crc = GetCrc.CRC
        #以上3行为获取压缩包CRC32值的步骤
        #print hex(crc)
        CrackCrc(crc)

dic = string.ascii_letters + string.digits + '+/='

f = open('out.txt', 'w')
CrackZip()
f.close()
```

base64转字节文件

z5BzAAANAAAAAAAAAKo+egCAIwBJAAAAVAAAAAKGNKv+a2MdSR0zAwABAAAAQ01UCRUUy91BT5UkSNPoj5hFEVFBRvefHSBCfG0ruGnKnygsMyj8SBaZHxsYHY84LEZ24cXtZ01y3k1K1YJ0vpK9HwqUzb6u9z8igEr3dCCQLQAdAAAAHQAAAAJi0efVT2MdSR0wCAAgAAAAZmxhZy50eHQAsDRpZmZpeCB0aGUgZmlsZSBhbmQgZ2V0IHRoZSBmbGFnxD17AEAHAA==

可以看到文件尾为07 00 是rar的文件尾，修补文件头526172211A0700

## 间谍启示录

在城际公路的小道上，罪犯G正在被警方追赶。警官X眼看他正要逃脱，于是不得已开枪击中了罪犯G。罪犯G情急之下将一个物体抛到了前方湍急的河流中，便头一歪突然倒地。警官X接近一看，目标服毒身亡。数分钟后，警方找到了罪犯遗失物体，是一个U盘，可惜警方只来得及复制镜像，U盘便报废了。警方现在拜托你在这个镜像中找到罪犯似乎想隐藏的秘密。 注意：得到的 flag 请包上 flag{} 提交

下载后是iso文件 用foremost分离

运行flag.exe得到flag

## swp

foremost分离pcag，有压缩包，可修复也可直接导出

## 吹着贝斯扫二维码

```py
#coding:utf-8
import os

path = "G:\\Github\\CTF-Note\\tools\\批量修改文件名后缀\\test"

for i in os.listdir(path):
    # print(i)
    if i == 'flag.zip':
        continue
    else:
        old_name = os.path.join(path,i)
        new_name = os.path.join(path,i + '.jpg')
        os.rename(old_name,new_name)
```

得到一堆二维码碎片。用ps拼接后扫描

BASE Family Bucket ???
85->64->85->13->16->32



压缩包注释如下：GNATOMJVIQZUKNJXGRCTGNRTGI3EMNZTGNBTKRJWGI2UIMRRGNBDEQZWGI3DKMSFGNCDMRJTII3TMNBQGM4TERRTGEZTOMRXGQYDGOBWGI2DCNBY

ThisIsSecret!233

## 小易的U盘

小易的U盘中了一个奇怪的病毒，电脑中莫名其妙会多出来东西。小易重装了系统，把U盘送到了攻防实验室，希望借各位的知识分析出里面有啥。请大家加油噢，不过他特别关照，千万别乱点他U盘中的资料，那是机密。 注意：得到的 flag 请包上 flag{} 提交

foremost分离iso

提示32exe有东西，打开寻找发现flag


## 从娃娃抓起
题目描述：伟人的一句话，标志着一个时代的开始。那句熟悉的话，改变了许多人的一生，为中国三十年来计算机产业发展铺垫了道路。两种不同的汉字编码分别代表了汉字信息化道路上的两座伟大里程碑。请将你得到的话转为md5提交，md5统一为32位小写。

0086 1562 2535 5174
bnhn s wwy vffg vffg rrhy fhnv

请将你得到的这句话转为md5提交，md5统一为32位小写。
提交格式：flag{md5}

中文电码和五笔编码

## alison_likes_jojo

题目描述：As we known, Alison is a pretty girl.

boki.jpg分离出一个zip，爆破出来密码是888866，得到一个文本多次base64解密后得到key：killerqueen

jljy.jpg是outguess隐写

outguess -k "killerqueen" -r jljy.jpg  hidden.txt

## zips

222.zip用ziperello爆破得到111.zip

111.zip有flag.zip和加密的setup.sh,先把flag.zip移出去，伪加密，可以用工具ZipCenOp.jar

打开setup.sh

```bash
#!/bin/bash
#
zip -e --password=`python -c "print(__import__('time').time())"` flag.zip flag

```

可以看到是时间戳
https://tool.chinaz.com/tools/unixtime.aspx

考虑到出题时间，前两位为15，15????????.?? 用archpr进行掩码爆破

flag{fkjabPqnLawhvuikfhgzyffj}

## (╯°□°）╯︵ ┻━┻

(╯°□°）╯︵ ┻━┻
50pt

(╯°□°）╯︵ ┻━┻

d4e8e1f4a0f7e1f3a0e6e1f3f4a1a0d4e8e5a0e6ece1e7a0e9f3baa0c4c4c3d4c6fbb9b2b2e1e2b9b9b7b4e1b4b7e3e4b3b2b2e3e6b4b3e2b5b0b6b1b0e6e1e5e1b5fd


```py
s = "d4e8e1f4a0f7e1f3a0e6e1f3f4a1a0d4e8e5a0e6ece1e7a0e9f3baa0c4c4c3d4c6fbb9b2b2e1e2b9b9b7b4e1b4b7e3e4b3b2b2e3e6b4b3e2b5b0b6b1b0e6e1e5e1b5fd"

str_s = ''
str_get = []

for j in range(129): # 循环测试所有数减掉1-128得到的ASCII码
    str_16 = ''
    for i in range(len(s)):
        if i % 2 ==0:
            str_s = s[i-2] + s[i-1]
            str_16 += chr(int(str_s,16)-j) # 十六进制转十进制
    print(str_16)


```

## 百里挑一

好多漂亮的壁纸，赶快挑一张吧！ 注意：得到的 flag 请包上 flag{} 提交

首先导出http对象

`exiftool * | grep flag` 发现一半flag

追踪TCP流在114处发现另一半flag 可以右下角点击流一个个翻阅特征exif

## 爬

010发现是pdf文件，修改后缀后，移动图片发现十六进制 解码得到flag

## Attack

foremost分离发现zip需要密码
wireshark导出http对象发现lsass.dmp

lsass是windows系统的一个进程，用于本地安全和登陆策略。mimikatz可以从 lsass.exe 里获取windows处于active状态账号明文密码。本题的lsass.dmp就是内存运行的镜像，也可以提取到账户密码

https://github.com/gentilkiwi/mimikatz/releases/

以管理员身份运行
```
privilege::debug
sekurlsa::minidump lsass.dmp
sekurlsa::logonpasswords full
```

 W3lc0meToD0g3

## 千层套路

打开文件，发现是个以数字命名的压缩包，解压密码恰好是那个数字，写个脚本跑一下

```py
import zipfile
name = '0573'
while True:
    fz = zipfile.ZipFile(name + '.zip', 'r')
    fz.extractall(pwd=bytes(name, 'utf-8'))
    name = fz.filelist[0].filename[0:4]
    fz.close()
```

```py
from PIL import Image

x = y = 200 # 需要手动将()去掉
img = Image.new("RGB",(x,y))
file = open('./qr.txt','r')

for width in range(0,x):
    for height in range(0,y):
        line = file.readline()
        rgb = line.split(',')
        img.putpixel((width,height),(int(rgb[0]),int(rgb[1]),int(rgb[2])))
img.save('flag.jpg')
```

需要手动将qr的()去掉

## girlfriend

听起来像是在打电话输入号码的声音，猜测DTMF拨号音识别，有个程序可以识别一下dtmf2num.exe

> dtmf2num.exe girlfriend.wav

999*666*88*2*777*33*6*999*4*4444*777*555*333*777*444*33*66*3*7777

手机键盘密码

999 ---> y666 ---> o88 ---> u2 ---> a777 ---> r33 ---> e6 ---> m999 ---> y4 ---> g4444 ---> i777 ---> r555 ---> l333 ---> f777 ---> r444 ---> i33 ---> e66 ---> n3 ---> d7777 ---> syouaremygirlfriends
flag{youaremygirlfriends}

## Game

先看源代码的index.html发现

 ON2WG5DGPNUECSDBNBQV6RTBNMZV6RRRMFTX2===


base32编码 suctf{hAHaha_Fak3_F1ag}

图片LSB分析得到加密的字符串


U2FsdGVkX1+zHjSBeYPtWQVSwXzcVFZLu6Qm0To/KeuHg8vKAxFrVQ==

因为U2FsdGVkX1开头可知道是DES加密

因为DES加密之后开头都是这几位，不过解密需要秘钥，就是前面的fake密钥

https://www.sojson.com/encrypt_triple_des.html

得到flag

## docx

binwalk 分离得到flag

## CyberPunk

更改系统时间即可

## followme

导出http对象，观察可知是个爆破密码，`grep -r 'CTF' ./output `

## USB

binwalk分离key.ftm,分离出usb流量包key.pcap

用UsbKeyboardDataHacker工具提取出流量，key值为xinan

010editor打开233.rar，根据分析rar文件头，具体可见misc/rar文件头，在第二行第六列发现7A应该是74，修改后多了一张图，stegolve在blue plane 0发现二维码，扫描后得到

ci{v3erf_0tygidv2_fc0}

维吉尼亚密码解密得到 fa{i3eei_0llgvgn2_sc0}

栅栏解密2得到flag

## 通行证

a2FuYmJyZ2doamx7emJfX19ffXZ0bGFsbg==

套娃题目

base64解密-栅栏密码 密钥7 - 凯撒密码

## 虚假的压缩包

```
数学题
n = 33
e = 3
解26

-------------------------
答案是
```

明显的rsa题

```py
import gmpy2

## 已知 p q e c 求 m
p = 3
q = 11
e = 3
c = 26
n = 33
s = (p- 1) * (q - 1)
d = gmpy2.invert(e,s)
m = pow(c,d,n)

print(pow(c, d, n))
```

压缩包密码：答案是5

得到图片和文件 图片改长宽发现要求异或5，写脚本

```py
original = open("亦真亦假",'r').read()
flag = open("flag",'w')
for i in original:
    tmp = int(i,16)^5
    flag.write(hex(tmp)[2:])
```
用notepad++右上角插件
hex->Ascii

后缀doc，全选换成蓝色发现flag


flag{_th2_7ru8_2iP_}

## Network

TTL隐写-得到压缩包-伪加密得到一堆base64字符，写脚本批量跑到底

flag{189ff9e5b743ae95f940a6ccc6dbd9ab}

## draw

```
cs pu lt 90 fd 500 rt 90 pd fd 100 rt 90 repeat 18[fd 5 rt 10] lt 135 fd 50 lt 135 pu bk 100 pd setcolor pick [ red orange yellow green blue violet ] repeat 18[fd 5 rt 10] rt 90 fd 60 rt 90 bk 30 rt 90 fd 60 pu lt 90 fd 100 pd rt 90 fd 50 bk 50 setcolor pick [ red orange yellow green blue violet ] lt 90 fd 50 rt 90 fd 50 pu fd 50 pd fd 25 bk 50 fd 25 rt 90 fd 50 pu setcolor pick [ red orange yellow green blue violet ] fd 100 rt 90 fd 30 rt 45 pd fd 50 bk 50 rt 90 fd 50 bk 100 fd 50 rt 45 pu fd 50 lt 90 pd fd 50 bk 50 rt 90 setcolor pick [ red orange yellow green blue violet ] fd 50 pu lt 90 fd 100 pd fd 50 rt 90 fd 25 bk 25 lt 90 bk 25 rt 90 fd 25 setcolor pick [ red orange yellow green blue violet ] pu fd 25 lt 90 bk 30 pd rt 90 fd 25 pu fd 25 lt 90 pd fd 50 bk 25 rt 90 fd 25 lt 90 fd 25 bk 50 pu bk 100 lt 90 setcolor pick [ red orange yellow green blue violet ] fd 100 pd rt 90 arc 360 20 pu rt 90 fd 50 pd arc 360 15 pu fd 15 setcolor pick [ red orange yellow green blue violet ] lt 90 pd bk 50 lt 90 fd 25 pu home bk 100 lt 90 fd 100 pd arc 360 20 pu home
```

logo语言

https://www.calormen.com/jslogo/

flag{RCTF_HeyLogo}

## 明文攻击

binwalk woojpg发现有zip，无法分离出来，需要手动添加zip文件头
504B0304

在0304前添加文件头504B

打开后得到this is the flag.

发现题给的压缩包里面有一个flag.txt，和刚解压出的txt大小相同，明文攻击

点击确定保存为zip文件，解压出现flag

## 蜘蛛侠呀

所有的icmp包后面都跟了一串数据，使用tshark把这些全部提取出来

`tshark -r out.pcap -T fields -e data > data.txt`

脚本去重-> 十六进制数据转为字符 -> 去除首尾两行，将base64解码以字节流形式写成zip，里面是一张图片，时间隐写

2050502050502050205020202050202020205050205020502050205050505050202050502020205020505050205020206666

20替换0 50替换 1

二进制转字符，然后md5

## UTCTF2020-file-header

题目提示很明显，拿到文件放进010，补上文件头89504e47，得到flag

## 安洵杯-2019-easy-misc

加密的压缩包注释有

```
FLAG IN ((√2524921X85÷5+2)÷15-1794)+NNULLULL,
```

计算可得 7+NNULLULL

掩码爆破

![image](./img/yanma1.png)

得到密码为2019456NNULLULL, 解压后得到如下：

```
a = dIW
b = sSD
c = adE
d = jVf
e = QW8
f = SA=
g = jBt
h = 5RE
i = tRQ
j = SPA
k = 8DS
l = XiE
m = S8S
n = MkF
o = T9p
p = PS5
q = E/S
r = -sd
s = SQW
t = obW
u = /WS
v = SD9
w = cw=
x = ASD
y = FTa
z = AE7
```

binwalk一下图片，可以发现有两张png图片，foremost即可

两张一模一样的图片可以联想到盲水印，跑出一张图片提示11.txt

```py
# -*- coding:utf-8 -*-
alphabet = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890!@#$%^&*()_+- =\\{\\}[]"
strings = open('./flag.txt',encoding='utf-8').read()

result = {}
for i in alphabet:
	counts = strings.count(i) # 计算出现的次数
	i = '{0}'.format(i)
	result[i] = counts

res = sorted(result.items(),key=lambda item:item[1],reverse=True)  # 排序操作 True降序
for data in res:
	print(data)

for i in res:
	flag = str(i[0])
	print(flag[0],end="")
```

etaonrhsidluygw 再结合decode.txt

QW8obWdIWT9pMkFSQWtRQjVfXiE/WSFTajBtcw==

base64解码得到Ao(mgHY?i2ARAkQB5_^!?Y!Sj0ms

## MRCTF2020-Hello_misc

图片binwalk后有加密的压缩包，红色的图片拿去stegsolve lsb隐写提取红色0发现有图片格式，save bin下来有密码，解压后文本可知是ttl隐写

隐写后得到0ac1fe6b77be5dbe

解压后发现是文档的格式，更改后缀，打开后全部加深颜色,notepad base64逐行解码得到二进制，0的形状就是flag


## BSidesSF2019-zippy

追踪tcp流

![image](./img/zip1.png)

可以看见是一个压缩包，密码是supercomplexpassword

binwalk分解下输入密码得到flag

## MRCTF2020-不眠之夜

https://mochu.blog.csdn.net/article/details/109649446?spm=1001.2101.3001.6650.1&utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7Edefault-1.no_search_link&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7Edefault-1.no_search_link


montage -tile 10x12 -geometry 200x100+0+0 *jpg flag.jpg
gaps --image=flag.jpg --generations=40 --population=120 --size=100


环境失败的话见misc 图片拼接

## hashcat

文档爆破，用Accent OFFICE Password Recovery爆破即可

ppt在倒数第二页全选红色即可

## 派大星的烦恼

首先放到010里搜索字节22,根据提示0x22，0x44 想到二进制,吧右边的DD"复制下来，将"替换成0 D替换成1，然后每8位一组倒序转为字符即可

## UTCTF2020-zero

vim打开可以发现有很多<200b>

零宽度字节隐写

http://330k.github.io/misc_tools/unicode_steganography.html

## 粽子的来历

FF 修复 4个文档
每个文档内容一样，但行间距不同，设置 1.5倍为 1，1倍为0，则有

```
100111100010
111110010011
100100100001
111100100001
```

第三个md5为flag

## MRCTF2020-Unravel!!

binwalk分离出aes.png，上面写Tokyo

010打开wav 末尾发现

key=U2FsdGVkX1/nSQN+hoHL8OwV9iJB/mSdKk5dmusulz4=

可知是aes解密 得到CCGandGulu ，解压压缩包得到wav

## UTCTF2020-basic-forensics

010全局搜索flag

## WUSTCTF2020-spaceclub

sublime打开全选有不可见字符，有两个不同长度，一个为6 一个为12

假设 6为0 12为1，写脚本转为二进制得到

011101110110001101110100011001100011001000110000001100100011000001111011011010000011001101110010011001010101111100110001011100110101111101111001001100000111010101110010010111110110011001101100010000000110011101011111011100110011000101111000010111110111001100110001011110000101111101110011001100010111100001111101

转字符得wctf2020{h3re_1s_y0ur_fl@g_s1x_s1x_s1x}

## CFI-CTF-2018-webLogon-capture

抓包追踪流url解密password即可

## SCTF2019-电单车

将wav文件放在audacity中查看波形图

将其转为0和1，细的为0宽的为1，0 0111010010101010011000100 011101001010101001100010
钥匙信号(PT224X) = 同步引导码(8bit) + 地址位(20bit) + 数据位(4bit) + 停止码(1bit)
地址位长度为20bit，后4位为数据位即01110100101010100110

flag{01110100101010100110}

## MRCTF2020-pyFlag

有三张图片，根据提示在末尾都有PK的十六进制，拼接起来得到一个压缩包，暴力破解密码是1234

最后base16-32-64-85解密即可

## watevrCTF-2019-Evil-Cuteness

```
dd if=attachment.jpg of=test.zip skip=21639 bs=1
```

也可以binwalk -e

## QCTF2018-X-man-A-face


打开是残缺的二维码 只缺少左上角和左下角的方块，截图补全即可


KFBVIRT3KBZGK5DUPFPVG2LTORSXEX2XNBXV6QTVPFZV6TLFL5GG6YTTORSXE7I=

base32解密

## *CTF2019-otaku

第一步伪加密

第二步 word取证，把隐藏文字的选项去掉即可

第三步，将隐藏文字转为存文本,文本以asci格式另存，用对应的winrar压缩，可以看到crc一样 再进行明文攻击

![image](./img/crc1.png)

得到图片，lsb隐写即可

## 湖南省赛2019-Findme

考点：多张图片隐藏信息

得到5张png图片，第一张不显示，需要爆破长宽高脚本利用

修复png图片，010editor补上IDAT标识

第一张stegsolve隐写，在blue plane2发现二维码，扫描得到

ZmxhZ3s0X3

第二张010打开，在结尾发现7z，寻找png文件尾，后面全部复制到新的文本，将7z替换成PK，解压，在第618.txt大小与其它不一样，发现字符

1RVcmVfc

第三张010打开 chunk[0]-chunk[6]的每一个数据块的crc值都是可打印的Ascii字符

```py
a = [0x33,0x52,0x6C,0x5A,0x33,0x30,0x3D]
for i in a:
    print(chr(i),end="")

#运行结果：3RlZ30=
```

3RlZ30=

第四张

```bash
exiftool 4.png
```

cExlX1BsY


第五张末尾处发现 Yzcllfc0lN

ZmxhZ3s0X3Yzcllfc0lNcExlX1BsY1RVcmVfc3RlZ30=

flag{4_v3rY_sIMpLe_PlcTUre_steg}

## UTCTF2020-File-Carving

下载后是一张图片，binwalk分离后有一个ELF文件，直接./执行即可

## GKCTF-2021-签到

在tcp stream eq 5 发现读取flag的http报文，复制十六进制，hex解码-》base64解码得到

```
wIDIgACIgACIgAyIK0wIjMyIjMyIjMyIjMyIjMyIjMyIjMyIjMyIjMyIjMyIjMyIjMyIjMiCNoQD
jMyIjMyIjMyIjMyIjMyIjMyIjMyIjMyIjMyIjoQDjACIgACIgACIggDM6EDM6AjMgAzMtMDMtEjM
t0SLt0SLt0SLt0SLt0SLt0SLt0SLt0SLt0SLt0SLt0SLt0SLt0SLt0SLt0iCNMyIjMyIjMyIjMyI
6AjMgAzMtMDMtEjMwIjO0eZ62ep5K0wKrQWYwVGdv5EItAiM1Aydl5mK6M6jlfpqnrQDt0SLt0SL
t0SLt0SLt0SLt0SLt0SLt0SLt0SLt0SLt0SLt0SLt0SLt0SLt0SLK0AIdZavo75mlvlCNMTM6EDM
z0yMw0SMyAjM6Q7lpb7lmrQDrsCZhBXZ09mTg0CIyUDI3VmbqozoPW+lqeuCN0SLt0SLt0SLt0SL
sxWZld1V913e7d2ZhFGbsZmZg0lp9iunbW+Wg0lp9iunbW+Wg0lp9iunbW+WK0wMxoTMwoDMyACM
DN0QDN0QDlWazNXMx0Wbf9lRGRDNDN0ard0Rf9VZl1WbwADIdRampDKilvFIdRampDKilvVKpM2Y
==QIhM0QDN0Q
```

根据别的报文可知，是base64反转，kali下：`cat 1 | rev`

## GUET-CTF2019-soul-sipse

out.wav可用Steghide无密码分离出download.txt

https://share.weiyun.com/5wVTIN3

下载得到GUET.png，修改为正确的PNG文件头得到

```
\u0034\u0030\u0037\u0030\u000d\u000a\u0031\u0032\u0033\u0034\u000d\u000a
```

unicode解码得到4070 1234

flag{5304}

## HDCTF2019-你能发现什么蛛丝马迹吗

内存取证

```bash
python2 vol.py -f ../memory.img imageinfo
```

![image](./img/vol1.png)

可以得知是win2003SP系统,接下来查看进程

```bash
python2 vol.py -f ../memory.img --profile=Win2003SP1x86 pslist
```

![image](./img/vol2.png)

发现DumpIT.exe，然后查看cmd命令使用记录

```bash
python2 vol.py -f ../memory.img --profile=Win2003SP1x86 cmdscan
```
![image](./img/vol3.png)

发现Flag字样，将DumpIt.exe这个程序dump下来


```bash
python2 vol.py -f ../memory.img --profile=Win2003SP1x86 memdump -p 1992 --dump-dir=../
```

foremost分离即可

key: Th1s_1s_K3y00000
iv: 1234567890123456

jfXvUoypb8p3zvmPks8kJ5Kt0vmEw0xUZyRGOicraY4=

给了key(密码)和iv(偏移量)，AES加密

## voip

## Business-Planning-Group

用010editor打开，在png结尾处发现了BPG：复制下来另存为，用honeyview打开即可

https://bellard.org/bpg/

## 真的很杂

foremost分离出压缩包，后缀改为apk，丢进androidkiller跑

flag{25f991b27fcdc2f7a82a2b34386e81c4}

## UTCTF2020-spectogram

https://www.sonicvisualiser.org/download.html

![image](./img/guangpu1.png)

flag{sp3tr0gr4m0ph0n3}


## INSHack2017-sanity

flag{Youre_sane_Good_for_you}

## ACTF新生赛2020-剑龙

颜文字解密得到welcom3!


`steghide extract -sf hh.jpg `

想要flag吗？解出我的密文吧~
U2FsdGVkX1/7KeHVl5984OsGUVSanPfPednHpK9lKvp0kdrxO4Tj/Q==

右键图片属性得到@#$%^&%%$)

des解密得到

think about stegosaurus

./stegosaurus -x O_O.pyc

## UTCTF2020-sstv

慢扫描电视（SSTV）

kali安装QSSTV

`apt-get install qsstv`

Options->Configuration->Sound勾选From file

然后点击这个小按钮，选择attachment.wav开始解码

## greatescape
在tcp流18发现ssc.key,且为TLS协议

![image](./img/greatescape1.png)

流19发现私钥，保存为1.key

![image](./img/greatescape2.png)

接下来编辑->首选项->protocols->TLS，再把1.key导入，就可以解密出内容了

![image](./img/greatescape3.png)

追踪TLS流可发现flag

## GWCTF2019-huyao

频域盲水印

`python2 pinyubwm.py --original huyao.png --image stillhuyao.png --result out.png`


## INSHack2019-INSAnity

flag{YouRe_Crazy_and_I_Love_it}

## MRCTF2020-小O的考研复试

```py
flag=0
j = 0
for i in range(19260817):
    flag = (flag*10+2)%1000000007

print('end:   ',flag)
```

注意：在循环增加print会耗费数倍时间

## BSidesSF2019-table-tennis

分析流量包，可发现ICMP包最后都有字符

```py
from scapy.all import *

packets = rdpcap('out.pcapng')

for packet in packets:
    if packet.haslayer(ICMP):
        if packet[ICMP].type == 0:
            print packet[ICMP].load[-8:]
```

base64解码得到flag

## RCTF2019-disk

1.010打开发现一部分ctf{unseCure_quick_form4t_vo1ume

2.7z打开发现fat文件，FAT文件就可以使用VeraCrypt进行挂载

密码猜测为：rctf 图片名提示：useless file for ctf just ignore it，图片无用，在password.txt有个Password 2，这里就有个盲区知识点，在挂载输入密码的时候，不同的密码可以进入不同的文件系统

重新挂载，输入密码为：RCTF2019

无法直接打开，通过Winhex->工具->打开磁盘打开这个盘

发现另一半flag
_and_corrupted_1nner_v0lume}

flag{unseCure_quick_form4t_vo1ume_and_corrupted_1nner_v0lume}

## key不在这里

https://cn.bing.com/search?q=key%E4%B8%8D%E5%9C%A8%E8%BF%99%E9%87%8C&m=10210897103375566531005253102975053545155505050521025256555254995410298561015151985150375568&qs=n&form=QBRE&sp=-1&sc=0-38&sk=&cvid=2CE15329C18147CBA4C1CA97C8E1BB8C

10210897103375566531005253102975053545155505050521025256555254995410298561015151985150375568

十进制转字符 脚本跑即可

## INSHack2018-Self-Congratulation

图片左上角有个一部分二维码 黑为1 白为0 转换为字符即可

## GKCTF-2021-excel-骚操作

将值为1 的单元格显示出来。
选中若干单元格，右击，单元格格式

ctrl+f 替换1为黑色可发现二维码

最后显示合适的列宽高 汉信码app扫描即可

## INSHack2019-gflag

G语言运行即可

## 很好的色彩呃？

ps提每部分色彩，发现只有最后两位不同

![image](./img/secai1.png)

9797112106101115

flag{aapjes}

## ACTF新生赛2020-frequency

属性备注+word隐藏文字组合 base64解码后字频统计


## XMAN2018排位赛-file

挂载：指的就是将设备文件中的顶级目录连接到Linux根目录下的某一目录，访问此目录就等同于访问设备。

```bash
mount attachment.img /mnt
cd /mnt
```

修复：
```bash
extundelete attachment.img --restore-all
```

在同级目录下会生成一个名为RECOVERED_FILES的文件夹。flag就在恢复的文件里。

## MRCTF2020-摇滚DJ-建议大声播放

qsstv

## 大流量分析一


统计出现最多的IP
统计 -> IPv4 Statistics -> All Addresses

## SCTF2019-Ready_Player_One

按住W往前走出屏幕就有flag了

flag{You_Are_The_Ready_Player_One!!!For_Sure!!!}

## GUET-CTF2019-520的暗示

猜jpg文件头FF D8 FF E0

和0x33异或

```py
data = open("photo.dat","rb")
strs = data.read()
flag = open("flag.jpg","ab+")
for i in strs:
	flag.write(bytes([i ^ 0x33]))
```

得到一张联通图片，基站定位即可

基站定位，桂林电子科技大学花江校区，即是flag

## GKCTF-2021-你知道apng吗

可以用ffmpeg转化为gif图片，再用screentogif分帧

用PS编辑->变换->扭曲，到这个程度可扫描

![image](./img/apng1.png)

flag{a3c7e4e5

第二个二维码扫描stegsolve -9b9d

第三个二维码直接扫 -ad20

第四个 -0327-288a235370ea}

## DDCTF2018-流量分析

给了pcap流量包和tip

```
流量分析
200pt

提示一：若感觉在中间某个容易出错的步骤，若有需要检验是否正确时，可以比较MD5: 90c490781f9c320cd1ba671fcb112d1c
提示二：注意补齐私钥格式
-----BEGIN RSA PRIVATE KEY-----
XXXXXXX
-----END RSA PRIVATE KEY-----
```

流量包中搜索KEY
`tcp contains "KEY"`

找到base64转为图片，发现密钥，用在线QRC识别后修补另存为本地1.key

-----BEGIN RSA PRIVATE KEY-----
MIICXAIBAAKBgQDCm6vZmclJrVH1AAyGuCuSSZ8O+mIQiOUQCvN0HYbj8153JfSQ
LsJIhbRYS7+zZ1oXvPemWQDv/u/tzegt58q4ciNmcVnq1uKiygc6QOtvT7oiSTyO
vMX/q5iE2iClYUIHZEKX3BjjNDxrYvLQzPyGD1EY2DZIO6T45FNKYC2VDwIDAQAB
AoGAbtWUKUkx37lLfRq7B5sqjZVKdpBZe4tL0jg6cX5Djd3Uhk1inR9UXVNw4/y4
QGfzYqOn8+Cq7QSoBysHOeXSiPztW2cL09ktPgSlfTQyN6ELNGuiUOYnaTWYZpp/
QbRcZ/eHBulVQLlk5M6RVs9BLI9X08RAl7EcwumiRfWas6kCQQDvqC0dxl2wIjwN
czILcoWLig2c2u71Nev9DrWjWHU8eHDuzCJWvOUAHIrkexddWEK2VHd+F13GBCOQ
ZCM4prBjAkEAz+ENahsEjBE4+7H1HdIaw0+goe/45d6A2ewO/lYH6dDZTAzTW9z9
kzV8uz+Mmo5163/JtvwYQcKF39DJGGtqZQJBAKa18XR16fQ9TFL64EQwTQ+tYBzN
+04eTWQCmH3haeQ/0Cd9XyHBUveJ42Be8/jeDcIx7dGLxZKajHbEAfBFnAsCQGq1
AnbJ4Z6opJCGu+UP2c8SC8m0bhZJDelPRC8IKE28eB6SotgP61ZqaVmQ+HLJ1/wH
/5pfc3AmEyRdfyx6zwUCQCAH4SLJv/kprRz1a1gx8FR5tj4NeHEFFNEgq1gmiwmH
2STT5qZWzQFz8NRe+/otNOHBR2Xk4e8IS+ehIJ3TvyE=
-----END RSA PRIVATE KEY-----



编辑->首选项->Protocols->TLS->RSA keys list Edit->添加key file->完成

追踪http流即可


## Beautiful_Side

foremost分离得到图片，是右半张二维码

https://merricx.github.io/qrazybox/

将其上传到 QRazyBox 尝试修复二维码。在纠错等级为高，遮掩层模式为 2 的时候发现可以成功提取出 flag。

记得，补全黑色部分后，也要把白色的部分填补上，因为灰色是算“空”的。

然后点击“Tools”，

选择“Extract QR Information”



![image](./img/xiubu1.png)

## DDCTF2018-第四扩展FS

binwalk分离出压缩包 密码为右键属性的备注

字频分析即可

## 我爱Linux

分析图片，找PNG图片结尾 FF D9 复制后面字符另存为文本

考点：python反序列化 +坐标转换

```py
import pickle

fp = open("123.txt","rb+")
fw = open('pickle.txt', 'w')
a=pickle.load(fp)
pickle=str(a)
fw.write( pickle )
fw.close()
fp.close()
```

```py
fw = open("pickle.txt","r")
text=fw.read( )
i=0
a=0

while i<len(text)+1:
    if(text[i]==']'):
       print('\n')
       a=0
    elif(text[i]=='('):
        if(text[i+2]==','):
            b=text[i+1]
            d=text[i+1]
            b=int(b)-int(a)
            c=1
            while c<b:
                print(" ", end="")
                c += 1
            print(text[i+5], end="")
            a=int(d)
        else:
            b=text[i+1]+text[i+2]
            d=text[i+1]+text[i+2]
            b=int(b)-int(a)
            c=1
            while c<b:
                print(" ", end="")
                c += 1
            print(text[i+6], end="")
            a=int(d)
    i +=1
```

## INSHack2018-42.tar.xz

- 考点：循环解压压缩包

```bash
while [ "`find . -type f -name '*.tar.xz' | wc -l`" -gt 0 ]; do
    find -type f -name "*.tar.xz" -exec tar xf '{}' \;
    -exec rm -- '{}' \;;
done;
```

bash test即可

当脚本运行开始报错时停止，得到名为flag的文件，strings命令查看一下字符串即可得到flag

## XMAN2018排位赛-AutoKey

打开wireshark发现全是usb流量，用UsbKeyboardDataHacker

`python3 UsbKeyboardDataHacker.py attachment.pcapng`


<CAP>是转换大小写的键，<DEL>就是删除键

得到：MPLRVFFCZEYOUJFJKYBXGZVDGQAURKXZOLKOLVTUFBLRNJESQITWAHXNSIJXPNMPLSHCJBTYHZEALOGVIAAISSPLFHLFSWFEHJNCRWHTINSMAMBVEXPZIZ

使用autokey爆破脚本即可，在py脚本修改密文

![image](./img/autokey1.png)


flag{JHAWLZKEWXHNCDHSLWBAQJTUQZDXZQPF}

## QCTF2018-X-man-Keyword

stegsolve lsb观察东西，猜测是LSB隐写

`python lsb.py extract attachment.png 1.txt lovekfc`

PVSF{vVckHejqBOVX9C1c13GFfkHJrjIQeMwf}

Nihilist密码

```py
import string
# enc是待解密的，grid的前半部分是题目给的密钥，然后从A到Z把其他的放到后面
enc='PVSF{vVckHejqBOVX9C1c13GFfkHJrjIQeMwf}'
grid='LOVEKFC'+'ABDGHIJMNPQRSTUWXY'
flag=''

for i in enc:
    if i in string.ascii_lowercase:
        index=grid.lower().index(i)
        flag+=string.ascii_lowercase[index]
        continue
    if i in string.ascii_uppercase:
        index=grid.upper().index(i)
        flag+=string.ascii_uppercase[index]
        continue
    flag+=i
print flag
```

flag{cCgeLdnrIBCX9G1g13KFfeLNsnMRdOwf}

## GKCTF2021-FireFox-Forensics

下载附件看到一个sqlite的数据库文件和一个json文件

`python3 firepwd.py logins.json `

flag{l337_h4xx0r5_c0mmun1c473_w17h_PNGs}

## INSHack2017-hiding-in-plain-sight

foremost即可

## HDCTF2019-信号分析

## BSidesSF2019-diskimage

```
zsteg -a attachment.png
```

![image](./img/zsteg1.png)

发现磁盘数据

分离FAT格式的数据
```
zsteg -e 'b8,rgb,lsb,xy' attachment.png > data.dat
```


使用TestDisk对文件进行分析
```
testdisk data.dat
```

一路回车 找到_LAG.ICO

![image](./img/zsteg2.png)

https://blog.csdn.net/mochu7777777/article/details/110079540

## RoarCTF2019-forensic

## INSHack2017-remote-multimedia-controller

流量包有一段很长的base64编码 循环解码即可

## INSHack2017-10-cl0v3rf13ld-lane-signal


010或者file命令可发现是jpeg文件，修改后缀即可

binwalk分离出png图片

![image](./img/file1.png)

左下角有摩斯电码.... . .-.. .--. -- . 解码得到helpme

binwalk信息表示png后还有些东西 010打开在png结尾处发现ogg格式,复制另存为ogg，用audacity打开

![image](./img/ogg1.png)

明显的摩斯电码

.. -. ... .- -.--. -- ----- .-. ..... ...-- ..--.- .-- .---- .-.. .-.. ..--.- -. ...-- ...- ...-- .-. ..--.- ....- --. ...-- -.-.-- -.--.-

flag{M0R53_W1LL_N3V3R_4G3!}

## NPUCTF2020-misc-碰上彩虹吃定彩虹

![image](./img/NPUCTF2020-1.png)

- 考点：零字节宽度隐写

根据图片提示以及vim查看发现有很多200b 则存在零字节隐写，拿去网站解密

![image](./img/npuctf2020-2.png)

得到do u know NTFS?

考点：NTFS隐写

用NTFSstreamseditor2读取

=wwZlZ=8W=cndwljcdcG8wdj8W8Z8dZllGjZc=8lWjnlWd8WwZ5j=l8ccWZcZGjd5ZwZ5WZ8d=Zcwjwl5Gnn=WdwcwlnWd5lGnZWlnnwdnjnw8ndnc58d5cndl=njZl=WddjwWWwZllj5c5jGwZnZ5W=cZljdwd8c=85ndGGljcl5ccwd=W=l8w=5lwWn8WnwnWlGZwdcnGGl5G=8W==cnnWZnWjZ=wWcGwZcWc8ncWW=5jnWwcZl8W=8cdwWldlnwW5ddwlnlwncWlcwGZddj5djZWc5jcWdn5jdjwnj85GWGjnjwGd=jZGj5j==jwjlw8dlwWj5Wjn5n8dwwdjZlc5lZwdWldZlnGwl85cWnjd=WcWlwj8WGdlGncnZWGGd5ZncW5d55nW5wl=Wj8jGWnWj8jwZ=ZwWZ88nWG5nn5WlWnGdWw5Zn8jdl=nGcnll8WncZjnGn=dlwn5W8wlWjlnl5ccnGWGnnnc58WnjlGnG55Zwdn5cZdjdZZ5WljG5G5wcldd=Wlc8Z=8nGj=jWd8w8Wd=w8nccc8wZdjcnGdljZnnj5ww8885=lcWW8W8j5dG8jZZwG55GjnwZ=W5Z8G5ZlGc5ZZncZ5cd8j85GW5nj=WWncn55Gj5nj5nwnW58jG8GcnjZdWcl8wj8n=cj=8l8cn5jjcjn8lldn=Gjw8=cjcdWWjGddZljdjdZnG8djnZccZldlWllw5ZZ8wj5Gn==5w8Z=j55n=ZZ5wdww8lndwd8Wlj8WGjnl=nncZ=W8ZZWZnjjlwWGZZlZc5c==d8Zl855wZn=W=w8wWjZ85cGc==5Z8ccjdw5GnZWnGjcdGGnZ5wwwWGG5d=W5ldjwGZZdZwdG5cGGnZGlGc=W5ccWZ8=cGljdGcdld=8cj8jwn=lj88ZZ5jn5lcZ=Gdw=Zl58WZZl5ccwccwG5d5w8Z5wllj5ddnn=5=w8588WwGj=l5G55dWG8cl=GcjWwlwG=lWWnZ=dZG85Gcjc5=wnw=j==Gndnddjwn5c=c5W5wwdWlG5nWZwnGw8=lcWldcwnG5Wcjj=cWlGZc8Gn58ZWjZ85ljlncZj5cc=dZWGjd=d8ncZ8www55=cw=GWZn5ZZlnWld=cWcnclWlZG5djGW=cl8=ZG8cZwwc8wl=88W5ZwZ=jwZGGlcWcWnZZ5Zj5w5ZdZclZZWnccGw==cG8W8ZWlc8wcZ555Z85ljWG5jZ=8=wllWjWjlZc5lG8cwWlnjlGlW=l5=n=lGwnjGGjGdwj85ddW5ZwZ=ddjWldj=cjljjGwndZjWWZGcdWcZW5cdldj8WZjGljlWncZ5=8jnZWjl8wjZG5Zwlcl5dd

考点：字词频率分析

ZW5jcnlwdG8= base64解码得到encrypto

接下来看lookatme文件

achnrvxzzuglarucalznwcygfggrufryvbzqjoxjymxvchhhdmliddcwmhghclpebtzwlojvew

全选可发现有摩斯电码

.- ..- - --- -.- . -.-- 解码得到AUTOKEY 提示autokey爆破


得到 CONGRATULATIONSONFINDINGMYSECRETNOWIWILLGIVEYOUTHEPASSWORDITISIAMTHEPASSWD

congratulation son finding my secret now i will give you the password it is i am the passwd


考点：encrypto软件解密

提示是个密码iamthepasswd 结合前面的encrypto软件解密

解密很久没反应，用strings输出可打印字符，发现有(Oh! You caught me! But...），010删掉即可 解密成功

得到一张彩虹图片


考点： 颜色后两位十六进制
foremost分离出压缩包 要密码 回到图片可以发现跟`很好的色彩呃？`类似,用PS提取出颜色

112 64 115 115 87 100

转ascii得到p@ssWd

eeeeeeeeeepaeaeeeaeeeeeeeaeeeeeeeeeeccccisaaaaeejeeeeeejiiiiiiLiiiiijeeeeeejeeeeeeeeeeeeeeeeeeeejcceeeeeeeeeeeeeeeeeeejaaiiiiiiijcciiiiiiiiiijaaijiiiiiiiiiiiiiiiiiiiijeeeeeeeeeeeeeeeeeeeeeeejcceeeeeeeeeeeejaaiiiijeeeeeeejceeeeeeeeeeeeeeeeeeeeeeeeejceeeeeeeeeeeeeeeeejaeeeeeejciiiiiiiiiiiiiiiiiiijaeeeejceeeeeeeeeeeeeeeeeejajciiiiiiiiiiiiiiiiiiijaaiiiijiijeeeeeeeeeeejcciiiiiiiiiiiiiiijaaij

提取大写字母

ALPHUCK

把上面大写字母去掉

https://www.dcode.fr/alphuck-language 解密

flag{1t's_v3ry_De1iCi0us~!}

## SUCTF2018-dead_z3r0

010打开发现开头base64信息，解码貌似没啥用，后面看着像pyc文件，把前面base64删掉另存为pyc文件

stegosaurus提取数据即可


## INSHack2018-so-deep

首先用Audacity打开转为频谱图发现一半flag

再根据题目提醒用 DeepSound打开，发现需要密码

则用john脚本爆破

https://github.com/magnumripper/JohnTheRipper/blob/bleeding-jumbo/run/deepsound2john.py

提取hashes.txt文件，再john爆破

`python3 deepsound2john.py final_flag.wav>hashes.txt`
`john hashes.txt`

flag{Aud1o_st3G4n0_1s_4lwayS_Th3_S4me}

## watevrCTF-2019-Unspaellablle

google可以搜到国外的剧本，用beyond compare工具对比下

可以看出多出来一些字符，拼起来就是

watevr{icantspeel_tiny.cc/2qtdez}

## *CTF2019-She

## XMAN2018排位赛-ppap

追踪很长的TCP流发现base64编码，拿去网站跑报错不能识别~ 则搜索~分割一一下，最终得到一张图片，一个 xml 文件，一个加密的包含 flag 的压缩包

将图片 foremost 之后可以得到很多图片，根据提示可以知道需要找一张 pirate 的图片。有海盗图片 脑洞很大猜出skullandcrossbones

flag{b31Ng_4_P1r4tE_1s_4lR1GHT_w1Th_M3}

https://blog.csdn.net/mochu7777777/article/details/110410893

## SUCTF2019-protocol

foremost分离压缩包可以得到很多图片

![image](./img/protocol1.png)

接着分析流量包 按长度排序可以发现

![image](./img/po.png)

往下读取十五个流量包这个字节可以发现

04 03 02 01 00 09 08 07 06 05 0e 0d 0c 0b 0a

后面十个为

06 07 0e 04 01 0d 00 02 0b 09

接着后面十五个是一样的 但十个是不一样的

总结起来，去掉15个多余重复的


```
04 03 02 01 00 09 08 07 06 05 0e 0d 0c 0b 0a
06 07 0e 04 01 0d 00 02 0b 09
01 0e 08 06 0d 0c 00 05 09 0b
02 09 03 05 01 07 0d 0b 0e 04
06 0d 0a 08 09 04 0b 03 0c 02
```


结合原来的图片寻找规律 假设第一行是对应15个有文字的图片，那么我们要读
取的顺序在第二行，如06对应第一行的第9列，以此类推

1  2  3  4  5  6  7  8  9  10 11 12 13 14 15
04 03 02 01 00 09 08 07 06 05 0e 0d 0c 0b 0a

suctf{My_usb_pr0toco1_s0_w3ak}

## De1CTF2019-Mine-Sweeping

用Dnspy反编译

![image](./img/dnspy1.png)

修改this.bIsMine为false 右键编辑类可修改

改完后编译，这样点到雷不会退出，一直点即可

## 羊城杯-2020-signin

玩具总动员里面，巴斯光年成功上天，胡迪给他发了一段加密短信，但是不知道是什么？你能帮巴斯光年破解吗？胡迪给了一段明文，一表人才，二表倒立，相信聪明的你一定可以帮助他吧！ 得到的 flag 需要包上 flag{} 提交。https://github.com/gwht/2020YCBCTF

BCEHACEIBDEIBDEHBDEHADEIACEGACFIBDFHACEGBCEHBCFIBDEGBDEGADFGBDEHBDEGBDFHBCEGACFIBCFGADEIADEIADFH

脑洞题：玩具总动员：Toy Story ->toy密码 可以理解是替换密码

```py
list1 = {'M':'ACEG','R':'ADEG','K':'BCEG','S':'BDEG','A':'ACEH','B':'ADEH','L':'BCEH','U':'BDEH','D':'ACEI','C':'ADEI','N':'BCEI','V':'BDEI','H':'ACFG','F':'ADFG','O':'BCFG','W':'BDFG','T':'ACFH','G':'ADFH','P':'BCFH','X':'BDFH','E':'ACFI','I':'ADFI','Q':'BCFI','Y':'BDFI'}
list2 = original_list = ['M','R','K','S','A','B','L','U','D','C','N','V','H','F','O','W','T','G','P','X','E','I','Q','Y']
list2_re =list2[::-1]

ori_str = 'BCEHACEIBDEIBDEHBDEHADEIACEGACFIBDFHACEGBCEHBCFIBDEGBDEGADFGBDEHBDEGBDFHBCEGACFIBCFGADEIADEIADFH'

flag_1 = ''
for i in range(0,len(ori_str),4):
    _val = ori_str[i:i+4]
    for key, val in list1.items():
        if val == _val:
            flag_1 += key
print(flag_1)
flag = ''
for i in flag_1:
    for j,k in enumerate(list2):
        if i == k:
            flag += list2_re[j]
print(flag)
```

flag{TOYSAYGREENTEAISCOOL}

## QCTF2018-picture

